<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jared Browser Test</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Geist:wght@300;400;500;600&display=swap');
        
        body {
            font-family: 'Geist', -apple-system, BlinkMacSystemFont, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #0f0f0f;
            color: #e8e8e8;
            min-height: 100vh;
            position: relative;
        }
        
        .cat-background {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: -1;
            pointer-events: none;
            opacity: 0.47;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .cat-art {
            font-family: 'Courier New', 'Lucida Console', 'Monaco', monospace;
            font-size: 44px;
            color: #fff;
            line-height: 1.10;
            margin: 0;
            padding: 0;
            text-align: left;
            white-space: pre;
            font-weight: normal;
            letter-spacing: 0;
            word-spacing: 0;
            font-variant: normal;
            text-rendering: optimizeSpeed;
            -webkit-font-smoothing: none;
            -moz-osx-font-smoothing: unset;
            user-select: none;
            text-shadow:
                0 0 18px #fff,
                0 0 6px #fff,
                0 0 2px #fff;
        }
        
        .container {
            background: rgba(26, 26, 26, 0.85);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 40px;
            position: relative;
            z-index: 1;
        }
        
        h1 {
            color: #ffffff;
            text-align: center;
            font-size: 2.4em;
            margin-bottom: 20px;
            font-weight: 300;
        }
        
        .warning {
            background: rgba(42, 42, 42, 0.85);
            border: 1px solid #444;
            border-radius: 6px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
            color: #cccccc;
        }
        
        .demo-section {
            background: rgba(30, 30, 30, 0.8);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 25px;
            margin: 25px 0;
            border-left: 4px solid #666;
        }
        
        .demo-section h3 {
            color: #f0f0f0;
            margin-top: 0;
            font-size: 1.2em;
        }
        
        button {
            background: #404040;
            color: #ffffff;
            border: 1px solid #555;
            border-radius: 6px;
            padding: 12px 24px;
            cursor: pointer;
            font-size: 14px;
            margin: 8px 8px 8px 0;
        }
        
        button:hover {
            background: #4a4a4a;
            border-color: #666;
        }
        
        .bypass-button {
            background: #5a3a3a;
            border-color: #8a5a5a;
            color: #f0d0d0;
        }
        
        .bypass-button:hover {
            background: #6a4a4a;
            border-color: #aa6a6a;
        }
        
        .status-button {
            background: #3a4a5a;
            border-color: #5a6a8a;
            color: #d0d0f0;
        }
        
        .status-button:hover {
            background: #4a5a6a;
            border-color: #6a7aaa;
        }
        
        .status {
            margin: 15px 0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 13px;
        }
        
        .status.success {
            background: #1a2e1a;
            border: 1px solid #2d4a2d;
            color: #b8f0b8;
        }
        
        .status.error {
            background: #2e1a1a;
            border: 1px solid #4a2d2d;
            color: #f0b8b8;
        }
        
        .status.info {
            background: #1a1a2e;
            border: 1px solid #2d2d4a;
            color: #b8b8f0;
        }
        
        .server-status {
            position: fixed;
            top: 15px;
            right: 15px;
            padding: 10px 15px;
            font-size: 12px;
            border: 1px solid #444;
            border-radius: 20px;
            background: #2a1a1a;
            color: #f0b8b8;
            z-index: 1000;
            max-width: 140px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .explanation {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid #2a2a2a;
            border-radius: 6px;
            padding: 18px;
            margin: 18px 0;
            font-size: 14px;
            color: #b8b8b8;
        }
        
        textarea, input[type="text"] {
            background: #1e1e1e;
            color: #e8e8e8;
            border: 1px solid #444;
            border-radius: 6px;
            font-family: monospace;
            font-size: 13px;
            padding: 12px;
            width: 100%;
            margin: 10px 0;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .input-group input {
            flex: 1;
        }
        
        .badge {
            background: #333;
            color: #ccc;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            margin-left: 8px;
        }
    </style>
</head>
<body>
    <div class="cat-background">
        <pre class="cat-art">    |\---/|
    | o,o |
     \_`_/-..----.
  ___/ `   ' ,""+ \
 (__...'   **\    |`.**_.'
   (_,...'(_,.`__)/'.....
        </pre>
    </div>
    
    <div id="serverStatus" class="server-status">Server Offline</div>
    
    <div class="container">
        <h1>Felix's Security Test</h1>
        <p style="text-align: center; color: #888; font-style: italic; margin-bottom: 20px;">Created by Jared</p>
        
        <div class="warning">
            ****SECURITY RESEARCH TOOL****<br><br>
            
            <strong>Test Purpose:</strong> The tests below with RED buttons should FAIL in a secure browser environment, 
            but if they succeed despite your security controls, they prove the fundamental vulnerability this test demonstrates.
            <br><br>
            
            <strong>Enable ALL possible DLP controls before testing:</strong>
            <ul style="text-align: left; margin: 15px 0; padding-left: 20px;">
                <li>Block all file downloads</li>
                <li>Block all printing capabilities</li>
                <li>Disable native messaging hosts</li>
                <li>Block localhost communication on non-standard ports</li>
                <li>Prevent file saving/exporting</li>
                <li>Block clipboard operations</li>
                <li>Disable browser extensions</li>
                <li>Block right-click context menus</li>
            </ul>
            
            <strong>Expected Result:</strong> Red buttons should still work, proving local applications can bypass browser-based DLP controls.
        </div>

        <div class="demo-section">
            <h3>GARFIELD SERVER STATUS <span class="badge">Required</span></h3>
            <p>First, verify that Garfield's hungry server is running and ready to serve data:</p>
            <button class="status-button" onclick="checkServerStatus()">Check Garfield Server Status</button>
            <div id="statusResult"></div>
            
            <div class="explanation">
                <strong>What this demonstrates:</strong> Just like Box Edit, Garfield's server runs on localhost. 
                Felix's web tricks can communicate with it even if downloads are blocked by the browser or DLP policies.
            </div>
        </div>

        <div class="demo-section">
            <h3>FILE DOWNLOAD BYPASS <span class="badge">Critical</span></h3>
            <p>Download sensitive files using Box Edit style bypass:</p>
            <button class="bypass-button" onclick="bypassDownload()">Box Edit Style Download</button>
            <button onclick="attemptDirectDownload()">Internet Download (Should Fail)</button>
            <div id="downloadResult"></div>
            
            <div class="explanation">
                <strong>Security Impact:</strong> Box Edit style communication bypasses secure browsers by mimicking 
                legitimate application traffic. Downloads file and opens location (just like real Box Edit).
                <br><br>
                <strong>Test:</strong> The "Internet Download" button attempts to download a large Ubuntu ISO file directly 
                through the browser - this should be blocked by DLP controls, while the Box Edit bypass succeeds.
            </div>
        </div>

        <div class="demo-section">
            <h3>PRINT BYPASS <span class="badge">High Risk</span></h3>
            <p>Send content directly to the printer using Box Edit style:</p>
            <button class="bypass-button" onclick="bypassPrint()">Box Edit Style Print</button>
            <button onclick="attemptDirectPrint()">Browser Print (Should Fail)</button>
            <div id="printResult"></div>
            
            <div class="explanation">
                <strong>Security Impact:</strong> Local applications can print documents even if the browser 
                has printing disabled. Box Edit style method opens documents in Notepad for review/printing.
                <br><br>
                <strong>Test:</strong> The "Browser Print" button uses browser print API - this should be blocked 
                by secure browsers, while the Box Edit style bypass succeeds.
            </div>
        </div>

        <div class="demo-section">
            <h3>CUSTOM FILE SAVE <span class="badge">High Risk</span></h3>
            <p>Save custom content to the server directory:</p>
            <textarea id="customContent" placeholder="Enter content to save to server directory..."></textarea>
            <div class="input-group">
                <input type="text" id="customFilename" placeholder="filename.txt">
                <button class="bypass-button" onclick="saveCustomFile()">Save to Server Directory</button>
            </div>
            <div id="customResult"></div>
            
            <div class="explanation">
                <strong>Security Impact:</strong> Files are saved directly to the server's running directory, 
                making them easily accessible alongside the server files. Any content displayed in the browser 
                can be extracted and saved locally through the helper application, regardless of browser security settings.
                <br><br>
                <strong>Test:</strong> This demonstrates how local applications can save arbitrary content to the 
                filesystem, bypassing any browser-based file save restrictions through localhost communication.
            </div>
        </div>
    </div>

    <div style="text-align: center; margin: 30px 0; padding: 20px; background: rgba(20, 20, 20, 0.8); border: 1px solid #333; border-radius: 8px;">
        <h3 style="color: #f0f0f0; margin-top: 0;">📁 Source Code & Downloads</h3>
        <p style="color: #ccc; margin: 15px 0;">
            Get the complete Felix & Garfield security testing toolkit:
        </p>
        
        <div style="margin: 20px 0;">
            <a href="https://github.com/yourusername/felix-garfield-security-test" 
               style="display: inline-block; background: #333; color: #fff; padding: 12px 24px; text-decoration: none; border-radius: 6px; margin: 5px; border: 1px solid #555;">
                🐱 GitHub Repository
            </a>
            <a href="https://github.com/yourusername/felix-garfield-security-test/archive/main.zip" 
               style="display: inline-block; background: #404040; color: #fff; padding: 12px 24px; text-decoration: none; border-radius: 6px; margin: 5px; border: 1px solid #555;">
                📦 Download ZIP
            </a>
        </div>
        
        <div style="font-size: 11px; color: #888; margin-top: 15px; line-height: 1.4;">
            <strong>⚠️ IMPORTANT DISCLAIMERS:</strong><br>
            • For authorized security testing and educational purposes only<br>
            • Only use on systems you own or have explicit permission to test<br>
            • Not responsible for misuse - users assume all responsibility<br>
            • Intended for cybersecurity professionals and researchers
        </div>
        
        <div style="font-size: 11px; color: #666; margin-top: 10px;">
            Repository includes: felix_test.html, garfield_server.py, documentation, and setup instructions
        </div>
    </div>

    <footer style="text-align: center; margin-top: 40px; padding: 20px; color: #666; font-size: 12px; border-top: 1px solid #333;">
        Felix's Security Test Tool - Created by Jared on June 4, 2025<br>
        Works with Garfield Server (garfield_server.py) - For educational and security testing purposes only
    </footer>

    <script>
        const LOCAL_SERVER = 'http://127.0.0.1:19847';

        async function makeRequest(url, options = {}) {
            const response = await fetch(url, {
                ...options,
                headers: { 'Content-Type': 'application/json', ...options.headers }
            });
            return await response.json();
        }

        async function checkServerStatus() {
            const statusDiv = document.getElementById('statusResult');
            const serverStatusDiv = document.getElementById('serverStatus');
            
            statusDiv.innerHTML = '<div class="status info">Checking server status...</div>';
            
            try {
                const result = await makeRequest(`${LOCAL_SERVER}/status`);
                statusDiv.innerHTML = `<div class="status success">[ONLINE] ${result.message}</div>`;
                serverStatusDiv.textContent = 'Server Online';
                serverStatusDiv.style.background = '#1a2a1a';
                serverStatusDiv.style.color = '#b8f0b8';
            } catch (error) {
                statusDiv.innerHTML = `<div class="status error">[OFFLINE] Connection failed<br><small>Make sure Garfield Server (garfield_server.py) is running on port 19847</small></div>`;
                serverStatusDiv.textContent = 'Server Offline';
            }
        }

        // === BOX EDIT STYLE BYPASS FUNCTIONS ===
        
        async function bypassDownload() {
            const resultDiv = document.getElementById('downloadResult');
            resultDiv.innerHTML = '<div class="status info">Initiating Box Edit style download...</div>';
            
            try {
                // Step 1: Create fake credentials (simulating Box.com token generation)
                const fakeToken = "bypass" + Math.random().toString(36).substr(2, 9);
                const fakeAuthCode = "auth" + Math.random().toString(36).substr(2, 15);
                const fileId = "1234567890123";
                
                // Step 2: Send Box Edit style command with exact URL pattern that Box Edit uses
                const timestamp = Date.now();
                const commandUrl = `${LOCAL_SERVER}/application_command?application=BoxEdit&com=bypass-${timestamp}&timeout=4&ms=${timestamp}`;
                
                // Step 3: Create Box Edit style JSON payload (exactly matches real Box Edit structure)
                const boxEditCommand = {
                    "command_type": "launch_application",
                    "file_id": fileId,
                    "auth_token": fakeToken,
                    "auth_code": fakeAuthCode,
                    "key_id": "demo123",
                    "efile_id": "demoFileId==",
                    "eauth_code": "demoAuthCode12345",
                    "browser_type": "Chrome",
                    "token_scope": "folder",
                    "timestamp": timestamp,
                    "shared_link": ""
                };
                
                // Step 4: Send POST request that looks identical to real Box Edit traffic
                const response = await fetch(commandUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(boxEditCommand)
                });
                
                const result = await response.json();
                
                // Step 5: Check if bypass was successful (like real Box Edit)
                if (result.success === "true") {
                    resultDiv.innerHTML = '<div class="status success">[SUCCESS] Box Edit style download completed! Check Downloads folder and File Explorer.</div>';
                } else {
                    resultDiv.innerHTML = '<div class="status error">[ERROR] Box Edit style command failed</div>';
                }
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">[ERROR] Box Edit bypass failed: ${error.message}</div>`;
            }
        }

        async function bypassPrint() {
            const resultDiv = document.getElementById('printResult');
            resultDiv.innerHTML = '<div class="status info">Sending to printer via Box Edit style...</div>';
            
            try {
                // Step 1: Create Box Edit style print command with timestamp
                const timestamp = Date.now();
                const commandUrl = `${LOCAL_SERVER}/application_command?application=BoxEdit&com=print-${timestamp}&timeout=4&ms=${timestamp}`;
                
                // Step 2: Create confidential document content
                const printCommand = {
                    "command_type": "print_document",
                    "content": `CONFIDENTIAL DOCUMENT - SECURITY BYPASS TEST
Classification: TOP SECRET
Generated: ${new Date().toLocaleString()}
Source: Box Edit Style Bypass

This document contains sensitive information:
- Employee SSN: 123-45-6789
- Financial Data: Q4 Revenue $2.5M  
- System Credentials: admin/password123
- Database Access: db.company.com:5432

SECURITY NOTICE: This document was printed despite browser
restrictions, demonstrating Box Edit style bypass.

Local applications can circumvent web-based security through
localhost communication that mimics legitimate applications.

END OF DOCUMENT`,
                    "timestamp": timestamp
                };
                
                // Step 3: Send Box Edit style print command
                const response = await fetch(commandUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(printCommand)
                });
                
                const result = await response.json();
                
                // Step 4: Display result (Notepad should open)
                if (result.success === "true") {
                    resultDiv.innerHTML = `<div class="status success">[PRINT] ${result.message || 'Document sent to Notepad successfully!'}</div>`;
                } else {
                    resultDiv.innerHTML = '<div class="status error">[ERROR] Box Edit style print failed</div>';
                }
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">[ERROR] Print bypass failed: ${error.message}</div>`;
            }
        }

        // === COMPARISON FUNCTIONS (SHOULD FAIL) ===

        async function saveCustomFile() {
            const content = document.getElementById('customContent').value;
            const filename = document.getElementById('customFilename').value || 'custom_file.txt';
            const resultDiv = document.getElementById('customResult');
            
            if (!content.trim()) {
                resultDiv.innerHTML = '<div class="status error">Please enter some content to save</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="status info">Saving file...</div>';
            
            try {
                const result = await makeRequest(`${LOCAL_SERVER}/execute_command`, {
                    method: 'POST',
                    body: JSON.stringify({
                        command_type: 'download_file',
                        filename: filename,
                        content: content
                    })
                });
                
                resultDiv.innerHTML = `<div class="status success">[SAVED] ${result.message}</div>`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">[ERROR] Save failed: ${error.message}</div>`;
            }
        }

        async function attemptDirectDownload() {
            const resultDiv = document.getElementById('downloadResult');
            resultDiv.innerHTML = '<div class="status info">Attempting internet download...</div>';
            
            try {
                const link = document.createElement('a');
                link.href = 'https://releases.ubuntu.com/22.04.3/ubuntu-22.04.3-desktop-amd64.iso';
                link.download = 'ubuntu-22.04.3-desktop-amd64.iso';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                setTimeout(() => {
                    resultDiv.innerHTML += '<div class="status error">[EXPECTED] Internet download should be blocked by DLP</div>';
                }, 2000);
            } catch (error) {
                resultDiv.innerHTML += `<div class="status success">[GOOD] Internet download blocked</div>`;
            }
        }

        async function attemptDirectPrint() {
            const resultDiv = document.getElementById('printResult');
            resultDiv.innerHTML = '<div class="status info">Attempting direct print...</div>';
            
            try {
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <html><body style="font-family: Arial; padding: 20px;">
                        <h1>CONFIDENTIAL DOCUMENT</h1>
                        <p>This should be blocked by secure browsers</p>
                    </body></html>
                `);
                printWindow.document.close();
                
                setTimeout(() => {
                    try {
                        printWindow.print();
                        printWindow.close();
                        resultDiv.innerHTML += '<div class="status error">[BAD] Browser print succeeded</div>';
                    } catch (error) {
                        resultDiv.innerHTML += '<div class="status success">[GOOD] Browser print blocked</div>';
                    }
                }, 1000);
            } catch (error) {
                resultDiv.innerHTML += `<div class="status success">[GOOD] Browser print blocked</div>`;
            }
        }
    </script>
</body>
</html>
